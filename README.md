# 📊 传感器数据图表工具

一个专为KeNaiXin APP数据设计的可视化工具，支持CSV文件导入和交互式图表展示。

## ✨ 功能特点

- 📈 **多种图表类型**: DIF趋势图、RAW趋势图、双系列对比、散点图
- 🔍 **数据筛选**: 按用户、入耳状态、左右耳筛选
- 🖱️ **交互体验**: 鼠标悬停查看详情、图表缩放、数据点选择
- 💾 **数据导出**: 导出筛选后的CSV数据
- 📱 **响应式界面**: 自动适配不同屏幕尺寸
- ☁️ **云端使用**: 免安装，浏览器直接使用（推荐）
- 💻 **本地运行**: 支持Python环境运行

## 📋 系统要求

### 方式一：云端使用（推荐）⭐
- **浏览器**: Chrome / Safari / Edge 等现代浏览器
- **网络**: 稳定的互联网连接
- **设备**: 电脑/手机/平板均可
- **特点**: 免安装，打开即用，永久访问

### 方式二：本地Python运行
- **Python**: 3.7 或更高版本
- **操作系统**: Windows / macOS / Linux
- **依赖**: 见 requirements.txt

## 🚀 快速开始

### 方案一：云端使用（强烈推荐）⭐

1. **部署到云端**（一次性操作）
   - 上传代码到GitHub
   - 在 Streamlit Cloud 部署
   - 获得访问链接

2. **使用**（永久可用）
   - 浏览器打开链接
   - 上传CSV文件
   - 查看图表分析

📖 **详细部署教程**: [云端部署教程.md](./云端部署教程.md)

> 💡 **提示**: 部署教程包含完整的图文指导，从GitHub上传到Streamlit Cloud部署的每一步都有详细说明。

### 方案二：本地运行

1. **Windows用户**
   ```
   双击运行 "启动工具.bat"
   ```

2. **macOS/Linux用户**
   ```bash
   ./启动工具.sh
   ```

3. **手动启动**
   ```bash
   pip install -r requirements.txt
   streamlit run csv_viewer.py
   ```

## ☁️ 云端部署

### 什么是云端部署？
将工具部署到云端服务器，让团队成员通过浏览器直接使用，无需安装Python或任何软件。

### 优势
- ✅ **免安装**: 打开浏览器就能用
- ✅ **永久在线**: 部署一次，永久使用
- ✅ **多设备**: 电脑/手机/平板都能访问
- ✅ **易分享**: 一个链接发给所有人
- ✅ **自动更新**: 代码更新后应用自动更新
- ✅ **数据安全**: 数据本地处理，不上传服务器

### 详细部署步骤
📖 **[查看完整部署教程](./云端部署教程.md)**

部署流程（3步完成）：
1. 上传代码到GitHub（5分钟）
2. 部署到Streamlit Cloud（5分钟）
3. 获得永久访问链接（永久使用）

### 部署成功示例
部署成功后，你将获得一个类似这样的链接：
```
https://sensor-data-viewer-你的用户名.streamlit.app
```

将此链接分享给团队，他们就可以直接使用！

## 📖 使用指南

### 1️⃣ 数据上传
- 从KeNaiXin APP导出CSV文件
- 点击左侧"📤 文件上传"按钮
- 选择CSV文件

### 2️⃣ 数据筛选
在"🔎 数据筛选"区域：
- **入耳状态**: 选择显示入耳/出耳数据
- **用户名**: 选择特定用户（可选）
- **左右耳**: 选择左耳/右耳数据（可选）

### 3️⃣ 图表查看
在"📈 图表展示"区域选择图表类型：

#### DIF趋势图
- 展示DIF数据的变化趋势
- 绿色线条标记
- 适合分析入耳检测精度

#### RAW趋势图
- 展示RAW数据的变化趋势
- 橙色线条标记
- 适合查看原始数据波动

#### 双系列对比
- 同时显示DIF和RAW数据
- 上下两个子图：趋势图 + 散点图
- 便于对比两种数据的关系

#### 散点图
- 以DIF为X轴，RAW为Y轴
- 不同颜色表示入耳/出耳状态
- 适合分析数据相关性

### 4️⃣ 数据交互
- **鼠标悬停**: 查看数据点详情
- **数据点详情**: 展开查看具体数值
- **图表操作**: 缩放、平移、重置视图

### 5️⃣ 数据导出
- **CSV导出**: 导出筛选后的数据
- **图表导出**: 右键点击图表 → "导出为PNG"

## 📊 CSV文件格式

### 必需字段
- `DIF百分比`: DIF数据百分比
- `RAW百分比`: RAW数据百分比

### 推荐字段
- `用户名`: 数据所属用户
- `MAC地址`: 设备MAC地址
- `时间`: 数据时间戳
- `是否入耳`: 入耳状态（是/否）
- `左右耳`: 左耳/右耳标识

### 示例CSV
```csv
用户名,MAC地址,时间,DIF百分比,RAW百分比,是否入耳,左右耳
user1,AA:BB:CC:DD:EE:FF,2024-01-01 10:00:00,75.5,82.3,是,左耳
user1,AA:BB:CC:DD:EE:FF,2024-01-01 10:01:00,76.2,83.1,是,左耳
user2,BB:CC:DD:EE:FF:AA,2024-01-01 10:02:00,45.3,52.7,否,右耳
```

## 🔧 依赖包说明

| 包名 | 版本 | 说明 |
|------|------|------|
| streamlit | ≥1.28.0 | Web应用框架 |
| pandas | ≥2.0.0 | 数据处理 |
| plotly | ≥5.15.0 | 交互式图表 |
| pyinstaller | ≥5.13.0 | 打包工具 |

## ❓ 常见问题

### Q: 运行时提示"模块未找到"？
A: 运行 `pip install -r requirements.txt` 安装依赖

### Q: 图表显示空白？
A: 检查CSV文件是否包含 `DIF百分比` 和 `RAW百分比` 字段

### Q: 打包的exe文件很大？
A: 正常现象，所有依赖都打包在内。简化版约30-50MB，完整版约50-100MB

### Q: 同事无法运行exe？
A: 确保是Windows系统，且未安装杀毒软件拦截

### Q: 程序启动慢？
A: 首次启动需要加载依赖，后续会更快

### Q: 打包exe时报错"importlib.metadata.PackageNotFoundError"?
A:
- **解决方案1**: 使用简化版打包脚本 `python build_simple_exe.py`
- **解决方案2**: 尝试重新安装依赖: `pip install --upgrade streamlit plotly pandas`
- **解决方案3**: 使用Python环境直接运行，无需打包

### Q: 完整版打包失败？
A: 推荐使用简化版，功能基本相同但打包成功率更高

### Q: 简化版和完整版有什么区别？
A:
| 功能 | 简化版 | 完整版 |
|------|--------|--------|
| 图表类型 | 4种 | 4种 |
| 数据筛选 | 支持 | 支持 |
| 界面风格 | 传统窗口 | 现代Web |
| 文件大小 | 30-50MB | 50-100MB |
| 打包难度 | 简单 | 复杂 |
| 交互功能 | 基础 | 丰富 |
| 推荐度 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ |

## 📝 更新日志

### v1.0.0 (2024-01-11)
- ✨ 初始版本发布
- ✅ 支持DIF/RAW数据可视化
- ✅ 多种图表类型
- ✅ 数据筛选和导出
- ✅ exe打包支持

## 🤝 技术支持

如有问题或建议，请联系开发团队。

## 📄 许可证

本工具仅供KeNaiXin项目内部使用。
